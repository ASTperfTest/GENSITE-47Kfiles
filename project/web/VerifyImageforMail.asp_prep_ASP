: 

  call com_creatvalidcode()
 
  sub com_creatvalidcode()
  response.expires = -9999
  response.addheader "pragma","no-cache"
  response.addheader "cache-ctrol","no-cache"
  response.contenttype = "image/bmp"
  randomize
  dim i, ii, iii
  const camount = 10
  const ccode = "0123456789"
  dim vcolordata(2)
  a=cint(int(rnd * 256))
  b=cint(int(rnd * 256))
  c=cint(int(rnd * 256))
  vcolordata(0) = chrb(a) & chrb(b) & chrb(c) '隨機產生顏色
  vcolordata(1) = chrb(255) & chrb(255) & chrb(255) '白色
  dim vcode(4), vcodes
  for i = 0 to 3
  vcode(i) = int(rnd * camount)  '隨機產生0~35
  vcodes = vcodes & mid(ccode, vcode(i) + 1, 1) '取得對應字元並串接
  next
  session("checkcodeformail") = vcodes  'vcodes既為產生的字串
  dim vnumberdata(36) 'vnumberdata(0)對應字元0的圖像 'vnumberdata(10)對應字元10的圖像
  vnumberdata(0)  = "1110000111110111101111011110111101001011110100101111010010111101001011110111101111011110111110000111"
  vnumberdata(1)  = "1111011111110001111111110111111111011111111101111111110111111111011111111101111111110111111100000111"
  vnumberdata(2)  = "1110000111110111101111011110111111111011111111011111111011111111011111111011111111011110111100000011"
  vnumberdata(3)  = "1110000111110111101111011110111111110111111100111111111101111111111011110111101111011110111110000111"
  vnumberdata(4)  = "1111101111111110111111110011111110101111110110111111011011111100000011111110111111111011111111000011"
  vnumberdata(5)  = "1100000011110111111111011111111101000111110011101111111110111111111011110111101111011110111110000111"
  vnumberdata(6)  = "1111000111111011101111011111111101111111110100011111001110111101111011110111101111011110111110000111"
  vnumberdata(7)  = "1100000011110111011111011101111111101111111110111111110111111111011111111101111111110111111111011111"
  vnumberdata(8)  = "1110000111110111101111011110111101111011111000011111101101111101111011110111101111011110111110000111"
  vnumberdata(9)  = "1110001111110111011111011110111101111011110111001111100010111111111011111111101111011101111110001111"
  vnumberdata(10) = "1111011111111101111111101011111110101111111010111111101011111100000111110111011111011101111000100011"
  vnumberdata(11) = "1000000111110111101111011110111101110111110000111111011101111101111011110111101111011110111000000111"
  vnumberdata(12) = "1110000011110111101110111110111011111111101111111110111111111011111111101111101111011101111110001111"
  vnumberdata(13) = "1000001111110111011111011110111101111011110111101111011110111101111011110111101111011101111000001111"
  vnumberdata(14) = "1000000111110111101111011011111101101111110000111111011011111101101111110111111111011110111000000111"
  vnumberdata(15) = "1000000111110111101111011011111101101111110000111111011011111101101111110111111111011111111000111111"
  vnumberdata(16) = "1110000111110111011110111101111011111111101111111110111111111011100011101111011111011101111110001111"
  vnumberdata(17) = "1000100011110111011111011101111101110111110000011111011101111101110111110111011111011101111000100011"
  vnumberdata(18) = "1100000111111101111111110111111111011111111101111111110111111111011111111101111111110111111100000111"
  vnumberdata(19) = "1110000011111110111111111011111111101111111110111111111011111111101111111110111110111011111000011111"
  vnumberdata(20) = "1000100011110111011111011011111101011111110001111111010111111101101111110110111111011101111000100011"
  vnumberdata(21) = "1000111111110111111111011111111101111111110111111111011111111101111111110111111111011110111000000011"
  vnumberdata(22) = "1000100011110010011111001001111100100111110101011111010101111101010111110101011111010101111001010011"
  vnumberdata(23) = "1000100011110011011111001101111101010111110101011111010101111101100111110110011111011001111000110111"
  vnumberdata(24) = "1110001111110111011110111110111011111011101111101110111110111011111011101111101111011101111110001111"
  vnumberdata(25) = "1000000111110111101111011110111101111011110000011111011111111101111111110111111111011111111000111111"
  vnumberdata(26) = "1110001111110111011110111110111011111011101111101110111110111011111011101001101111011001111110001011"
  vnumberdata(27) = "1000001111110111011111011101111101110111110000111111010111111101101111110110111111011101111000110011"
  vnumberdata(28) = "1110000011110111101111011110111101111111111001111111111001111111111011110111101111011110111100000111"
  vnumberdata(29) = "1000000011101101101111110111111111011111111101111111110111111111011111111101111111110111111110001111"
  vnumberdata(30) = "1000100011110111011111011101111101110111110111011111011101111101110111110111011111011101111110001111"
  vnumberdata(31) = "1000100011110111011111011101111101110111111010111111101011111110101111111010111111110111111111011111"
  vnumberdata(32) = "1001010011110101011111010101111101010111110101011111001001111110101111111010111111101011111110101111"
  vnumberdata(33) = "1000100011110111011111101011111110101111111101111111110111111110101111111010111111011101111000100011"
  vnumberdata(34) = "1000100011110111011111011101111110101111111010111111110111111111011111111101111111110111111110001111"
  vnumberdata(35) = "1100000011110111011111111101111111101111111110111111110111111111011111111011111111101110111100000011"
  '底下的程式 在產生 圖檔
  response.binarywrite chrb(66) & chrb(77) & chrb(230) & chrb(4) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(54) & chrb(0) & chrb(0) & chrb(0) & chrb(40) & chrb(0) & chrb(0) & chrb(0) & chrb(40) & chrb(0) & chrb(0) & chrb(0) & chrb(10) & chrb(0) & chrb(0) & chrb(0) & chrb(1) & chrb(0)
  response.binarywrite chrb(24) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(176) & chrb(4) & chrb(0) & chrb(0) & chrb(18) & chrb(11) & chrb(0) & chrb(0) & chrb(18) & chrb(11) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0) & chrb(0)
  for i = 9 to 0 step -1 
  for ii = 0 to 3    
  for iii = 1 to 10 
  if rnd * 99 + 1 <2 then   ' < 右方的數值越大 代表產生的圖越看不清楚原本的字 
   response.binarywrite vcolordata(0) '使用隨機產生的顏色
  else
   response.binarywrite vcolordata(mid(vnumberdata(vcode(ii)), i * 10 + iii, 1))
  end if
  ' 0 <= vcode(x) <= 35; 91~100 .. 81~90 ...... 1~10;
  'response.binarywrite vcolordata(mid(vnumberdata(vcode(ii)), i * 10 + iii, 1))
  next
  next
  next
  end sub  
 