<?xml version="1.0" encoding="utf-8"?>
<htPage>
	<!--  -->
	<HTProgPrefix>CtUnit</HTProgPrefix>
	<!--  -->
	<HTProgCode>GE1T11</HTProgCode>
	<!--  -->
	<HTProgPath>/GipDSD</HTProgPath>
	<!--  -->
	<HTGenPattern>genList</HTGenPattern>
	<!--  -->
	<resultSet>
		<sql>
			<selectList>
				SELECT htx.ctUnitId, htx.ctUnitName, htx.ctUnitKind, htx.ibaseDsd, xr1.deptName, xr1.deptId
					,(SELECT count(*) FROM CatTreeNode WHERE ctUnitId=htx.ctUnitId) AS NodeCount
					,(SELECT count(*) FROM CuDtGeneric WHERE ictunit=htx.ctUnitId) AS ItemCount
			</selectList>
			<fromList>
				FROM CtUnit AS htx LEFT JOIN Dept AS xr1 ON xr1.deptId=htx.deptId
			</fromList>
			<whereList>
				where 1=1 
			</whereList>
			<orderList> ORDER BY htx.ctUnitName, htx.ctUnitKind, htx.ibaseDsd</orderList>
		</sql>
		<fieldList>
			<tableName>CtUnit</tableName>
			<!-- 一對多Table 'Y'~Master -->
			<masterTable>Y</masterTable>
			<field>
				<fieldName>ctUnitId</fieldName>
				<fieldLabel>主題單元ID</fieldLabel>
				<dataType>int</dataType>
				<dataLen>4</dataLen>
				<inputLen>4</inputLen>
				<canNull>N</canNull>
				<isPrimaryKey>Y</isPrimaryKey>
				<identity>Y</identity>
				<inputType>hidden</inputType>
				<fieldDesc></fieldDesc>
				<refLookup></refLookup>
				<rows></rows>
				<cols></cols>
			</field>			
			<field>
				<fieldName>ctUnitName</fieldName>
				<fieldLabel>主題單元名稱</fieldLabel>
				<dataType>varchar</dataType>
				<dataLen>30</dataLen>
				<inputLen>30</inputLen>
				<canNull>Y</canNull>
				<isPrimaryKey>N</isPrimaryKey>
				<identity>N</identity>
				<inputType>textbox</inputType>
				<fieldDesc>作為分類節點的預設值</fieldDesc>
				<refLookup></refLookup>
				<rows></rows>
				<cols></cols>
			</field>
			<field>
				<fieldName>ctUnitKind</fieldName>
				<fieldLabel>單元類型</fieldLabel>
				<dataType>char</dataType>
				<dataLen>1</dataLen>
				<inputLen>1</inputLen>
				<canNull>N</canNull>
				<isPrimaryKey>N</isPrimaryKey>
				<identity>N</identity>
				<inputType>refSelect</inputType>
				<fieldDesc></fieldDesc>
				<refLookup>refCTUKind</refLookup>
				<rows></rows>
				<cols></cols>
			</field>
			<field>
				<fieldName>ibaseDsd</fieldName>
				<fieldLabel>單元資料定義</fieldLabel>
				<dataType>int</dataType>
				<dataLen>4</dataLen>
				<inputLen>4</inputLen>
				<canNull>Y</canNull>
				<isPrimaryKey>N</isPrimaryKey>
				<identity>N</identity>
				<inputType>refSelect</inputType>
				<fieldDesc></fieldDesc>
				<refLookup>refBaseDSD</refLookup>
				<rows></rows>
				<cols></cols>
			</field>
			<field>
				<fieldName>deptId</fieldName>
				<fieldLabel>單位</fieldLabel>			
			</field>
			<field>
				<fieldName>nodeCount</fieldName>
				<fieldLabel>項目節點數</fieldLabel>
			
			</field>
			<field>
				<fieldName>itemCount</fieldName>
				<fieldLabel>資料筆數</fieldLabel>
			
			</field>									
		</fieldList>
	</resultSet>
	<pageSpec>
		<pageHead>主題單元管理</pageHead>
		<pageFunction>單元清單</pageFunction>
		<aidLinkList>
			<Anchor>
				<AnchorLabel>新增</AnchorLabel>
				<AnchorType>A</AnchorType>
				<AnchorDesc>新增</AnchorDesc>
				<AnchorURI>AddShowForm.do?formType=gipadmin/xmlspec/CtUnitAdd.xml</AnchorURI>
				<checkRight>4</checkRight>
				<AnchorPos>Top</AnchorPos>
				<AnchorWPK></AnchorWPK>
			</Anchor>		
			<Anchor>
				<AnchorLabel>查詢</AnchorLabel>
				<AnchorType>A</AnchorType>
				<AnchorDesc>重設查詢條件</AnchorDesc>
				<AnchorURI>query.do?queryspec=CtUnitQuery.xml&amp;listspec=CtUnitList.xml</AnchorURI>
				<checkRight>1</checkRight>
				<AnchorPos>Top</AnchorPos>
				<AnchorWPK></AnchorWPK>
			</Anchor>
			<Anchor>
				<AnchorLabel>回前頁</AnchorLabel>
				<AnchorType>Back</AnchorType>
				<AnchorDesc>回前頁</AnchorDesc>
				<AnchorURI>javascript:window.history.back();</AnchorURI>
				<checkRight></checkRight>
				<AnchorPos>Top</AnchorPos>
			</Anchor>
		</aidLinkList>
		<scriptCode><![CDATA[

		]]></scriptCode>
		<detailRow>
			<colSpec>
				<colLabel>主題單元名稱</colLabel>
				<content><refField>ctUnitName</refField></content>
				<url>update_do.asp?specID=CtUnit</url>
			</colSpec>
			<colSpec>
				<colLabel>單元類型</colLabel>
				<content><refField>ctUnitKind</refField></content>
			</colSpec>
			<colSpec>
				<colLabel>單元資料定義</colLabel>
				<content><refField>ibaseDsd</refField></content>
			</colSpec>
			<colSpec>
				<colLabel>單位</colLabel>
				<content><refField>deptId</refField></content>
			</colSpec>			
			<colSpec>
				<colLabel>項目節點數</colLabel>
				<content><refField>nodeCount</refField></content>
				<url></url>
				<target>_blank</target>
			</colSpec>
			<colSpec>
				<colLabel>資料筆數</colLabel>
				<content><refField>itemCount</refField></content>
			</colSpec>					
		</detailRow>
		<UINotes>
		</UINotes>
	</pageSpec>
</htPage>
